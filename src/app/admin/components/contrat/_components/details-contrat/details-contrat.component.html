<div class="content-body">
  <div class="container-fluid">
    <div class="card col rounded p-3 mt-3 shadow-sm border-0">
      <div class="card-body d-flex align-items-center justify-content-between">
        <h4 class="card-title mb-0 text-primary fw-bold">Détails Contrats</h4>
        <div class="d-flex gap-3">
          <button
            type="button"
            class="btn btn-danger btn-sm text-white px-4 d-flex align-items-center"
            (click)=" printContract()"
          >
            <mat-icon class="me-2">print</mat-icon> Imprimer
          </button>

          <button
            type="button"
            class="btn btn-dark btn-sm text-white px-4 d-flex align-items-center"
            (click)="openDialog()"
          >
            <mat-icon class="me-2">add</mat-icon> Effectuer un paiement
          </button>
        </div>
      </div>
    </div>
  <mat-card>
   


      <mat-tab-group>
        <mat-tab>
          <ng-template mat-tab-label>Contrat</ng-template>
          <mat-card class="contract-container">
            <div class="contract-content">
              <mat-card-header class="contract-header">
                <div class="header-content">
                  <img src="assets/admin/images/logo.jpg" alt="Logo" class="contract-logo" />
                  <div class="contract-title">
                    <h3>CONTRAT DE LOCATION</h3>
                    <mat-card-title>N° {{ infoContrat?.id }}</mat-card-title>
                  </div>
                </div>
              </mat-card-header>
        
              <mat-card-content>
                <p class="center-text"><strong>Date de signature :</strong> {{ infoContrat?.created_at | date:'fullDate' }}</p>
                <p class="center-text"><strong>Locataire :</strong> {{ infoContrat?.reservation?.nom }} {{ infoContrat?.reservation?.prenom }}</p>
                <p class="center-text"><strong>Propriété :</strong> {{ infoContrat?.reservation?.propriete.nom }}</p>
                <p class="center-text"><strong>Adresse :</strong> {{ infoContrat?.reservation?.propriete.adresse }}</p>
                <p class="center-text"><strong>Durée :</strong> Du {{ infoContrat?.paiements[0]?.date_debut | date:'fullDate' }} au {{ infoContrat?.paiements[infoContrat.paiements.length-1]?.date_fin | date:'fullDate' }}</p>
                <p class="center-text"><strong>Loyer total :</strong> {{ infoContrat?.total_paiement }} FCFA</p>
        
                <mat-divider></mat-divider>
        
                <h3>Clauses du contrat :</h3>
                <p><strong>Article 1 :</strong> Objet du contrat</p>
                <p>Le présent contrat a pour objet la location de la propriété située à {{ infoContrat.reservation?.propriete.adresse }}.</p>
        
                <p><strong>Article 2 :</strong> Durée du bail</p>
                <p>La location est accordée pour une durée déterminée de {{ getDureeContrat() }} jours, débutant le {{ infoContrat.paiements[0]?.date_debut | date:'fullDate' }} et prenant fin le {{ infoContrat.paiements[infoContrat.paiements.length-1]?.date_fin | date:'fullDate' }}.</p>
        
                <p><strong>Article 3 :</strong> Montant et modalités de paiement</p>
                <p>Le montant total à payer pour cette période de location est de {{ infoContrat?.total_paiement }} FCFA, payable selon les modalités convenues.</p>
        
                <mat-divider></mat-divider>
        
                <p><strong>Article 4 :</strong> Obligations du locataire</p>
                <p>Le locataire s'engage à utiliser les lieux de manière paisible et à respecter toutes les obligations liées au présent contrat.</p>
        
                <p><strong>Article 5 :</strong> Obligations du bailleur</p>
                <p>Le bailleur s’engage à fournir un logement en bon état et à réaliser les réparations nécessaires en cas de défaut majeur.</p>
        
                <mat-divider></mat-divider>
        
                <p class="center-text"><strong>Fait à :</strong> [Ville], le {{ infoContrat?.created_at | date:'fullDate' }}</p>
                <div class="signature-section">
                  <p><strong>Signature du bailleur :</strong> ___________________</p>
                  <p><strong>Signature du locataire :</strong> ___________________</p>
                </div>
              </mat-card-content>
            </div>
          </mat-card>
        </mat-tab>
        


        <mat-tab>
          <ng-template mat-tab-label>Paiement</ng-template>
          <!-- Liste de paiement -->
          <div class="row">
            <div class="col">
              <mat-card>
                <mat-card-header>
                  <div class="  " style="color: green;">Solde =  {{infoContrat?.total_paiement}}  </div >
                </mat-card-header>
                <mat-card-content>
                  <mat-form-field class="w-100" appearance="outline">
                    <mat-label>Rechercher...</mat-label>
                    <input matInput (keyup)="applyFilter($event)"
                      placeholder="Rechercher" #input>
                  </mat-form-field>
                  <table mat-table [dataSource]="dataSource" class="mat-elevation-z8" style="width: 100%;"id="maTable">
                    <!-- ID Column -->
                    <ng-container matColumnDef="id">
                      <th mat-header-cell *matHeaderCellDef>#</th>
                      <td mat-cell *matCellDef="let i=index">{{ i+1 }}</td>
                    </ng-container>


                    <!-- Name Column -->
                    <ng-container matColumnDef="montant">
                      <th mat-header-cell *matHeaderCellDef>Montant</th>
                      <td mat-cell *matCellDef="let element">{{ element.montant }} GNF</td>
                    </ng-container>

                    <!-- Status Column -->
                    <ng-container matColumnDef="mode_paiement">
                      <th mat-header-cell *matHeaderCellDef>Mode Paiement</th>
                      <td mat-cell *matCellDef="let element">
                        <span >{{ element.mode_paiement }}</span>
                      </td>
                    </ng-container>

                    <ng-container matColumnDef="date_debut">
                      <th mat-header-cell *matHeaderCellDef>Date Debut</th>
                      <td mat-cell *matCellDef="let element">
                        <span >{{ element.date_debut }}</span>
                      </td>
                    </ng-container>

                    <!-- Date Column -->
                    <ng-container matColumnDef="date_fin">
                      <th mat-header-cell *matHeaderCellDef>Date Fin</th>
                      <td mat-cell *matCellDef="let element">{{ element.date_fin }}</td>
                    </ng-container>



                    <!-- Action Column -->
                    <ng-container matColumnDef="action">
                      <th mat-header-cell *matHeaderCellDef class="text-center">Action</th>
                      <td mat-cell *matCellDef="let element" class="text-center">
                        <button mat-icon-button color="primary" routerLink="/operation/detail-paiement/{{element.id}}">
                          <mat-icon >edit</mat-icon>
                        </button>
                        <button mat-icon-button color="warn" (click)="deleteFunction(element.id ,'paiements')">
                          <mat-icon>delete</mat-icon>
                        </button>
                      </td>
                    </ng-container>

                    <!-- Header and Row Declarations -->
                    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                  </table>
                    <!-- Paginator -->
                    <mat-paginator [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons></mat-paginator>
                </mat-card-content>
              </mat-card>
            </div>
          </div>
        </mat-tab>
      </mat-tab-group>
  </mat-card>

  </div>
</div>
