
<div class="content-body">
  <div class="container-fluid">
    <div class="row">
      <div class="col-md-4 mb-4">
        <div class="card shadow-sm rounded">
          <div class="card-body">
            <h4 class="fw-bold text-dark text-center mb-4">Ajouter une Propriété</h4>
            <form [formGroup]="Propriete">
              <!-- Sélection du quartier et type de propriété -->
              <div class="row mb-4">
                <div class="col-md-6 mb-3">
                  <label for="quartier_id" class="form-label">Quartier</label>
                  <ng-select id="quartier_id" formControlName="quartier_id" [items]="Quartier" bindLabel="libelle"
                    bindValue="id" class="form-control"></ng-select>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="typepropriete_id" class="form-label">Type de Propriété</label>
                  <ng-select id="typepropriete_id" formControlName="typepropriete_id" [items]="typePropriete"
                    bindLabel="libelle" bindValue="id" class="form-control"></ng-select>
                </div>
              </div>

              <!-- Référence et Partenaire -->
              <div class="row mb-4">
                <div class="col-md-6 mb-3">
                  <label for="reference" class="form-label">Référence</label>
                  <input type="text" class="form-control form-control-lg" id="reference" formControlName="reference"
                    placeholder="Entrez la référence" />
                </div>
                <div class="col-md-6 mb-3">
                  <label for="partenaire_id" class="form-label">Partenaire</label>
                  <ng-select id="partenaire_id" formControlName="partenaire_id" [items]="Partenaire" bindLabel="libelle"
                    bindValue="id" class="form-control"></ng-select>
                </div>
              </div>

              <!-- Adresse et État -->
              <div class="row mb-4">
                <div class="col-md-6 mb-3">
                  <label for="adresse" class="form-label">Adresse</label>
                  <input type="text" class="form-control form-control-lg" id="adresse" formControlName="adresse"
                    placeholder="Entrez l'adresse" />
                </div>
                <div class="col-md-6 mb-3">
                  <label for="etat" class="form-label">État</label>
                  <select class="form-select form-control-lg" id="etat" formControlName="etat">
                    <option value="location">En Location</option>
                    <option value="vente">En Vente</option>
                  </select>
                </div>
              </div>

              <!-- Prix -->
              <div class="row mb-4">
                <div class="col-md-6 mb-3">
                  <label for="prix_journalier" class="form-label">Prix Journalier</label>
                  <input type="number" class="form-control form-control-lg" id="prix_journalier"
                    formControlName="prix_journalier" placeholder="Entrez le prix journalier" />
                </div>
                <div class="col-md-6 mb-3">
                  <label for="prix_mensuel" class="form-label">Prix Mensuel</label>
                  <input type="number" class="form-control form-control-lg" id="prix_mensuel"
                    formControlName="prix_mensuel" placeholder="Entrez le prix mensuel" />
                </div>
              </div>

              <!-- Image -->
              <div class="mb-4">
                <label for="image" class="form-label">Image</label>
                <input type="file" (change)="onFileChange($event)" formControlName="poster" class="form-control" />
                <div class="image-preview-container text-end mt-3" *ngIf="imagePreview">
                  <img [src]="imagePreview" class="image-preview img-fluid" />
                </div>
              </div>

              <!-- Description -->
              
            </form>
          </div>
          <div class="card-footer d-flex justify-content-between">
            <button type="submit" class="btn btn-primary btn-lg" (click)="saveDataPropriete()">Ajouter</button>
            <button type="reset" class="btn btn-outline-secondary btn-lg">Annuler</button>
          </div>
        </div>
      </div>

      <div class="col-md-8">
        <div class="card shadow-sm rounded">
          <div class="card-body">
            <h4 class="fw-bold text-dark text-center mb-4">Liste des Propriétés</h4>
            <div class="table-responsive">
              <table mat-table [dataSource]="dataSource" class="mat-elevation-z8" style="width: 100%" id="maTable">
                <!-- ID Column -->
                <ng-container matColumnDef="id">
                  <th mat-header-cell *matHeaderCellDef>#</th>
                  <td mat-cell *matCellDef="let i = index">{{ i + 1 }}</td>
                </ng-container>

                <!-- Name Column -->
                <ng-container matColumnDef="reference">
                  <th mat-header-cell *matHeaderCellDef>Reference</th>
                  <td mat-cell *matCellDef="let element">
                    {{ element.reference }} <br />
                    <span style="color: blue"> {{ element.etat }} </span>
                  </td>
                </ng-container>

                <!-- adresse Column -->
                <ng-container matColumnDef="adresse">
                  <th mat-header-cell *matHeaderCellDef>Adresse</th>
                  <td mat-cell *matCellDef="let element">
                    <span>{{ element.adresse }}</span>
                  </td>
                </ng-container>
                <!-- description Column -->
                <ng-container matColumnDef="descriptions">
                  <th mat-header-cell *matHeaderCellDef>Description</th>
                  <td mat-cell *matCellDef="let element">
                    <span>{{ element.descriptions | truncate : 20 }}</span>
                  </td>
                </ng-container>
                <!-- Date Column -->
                <ng-container matColumnDef="statut">
                  <th mat-header-cell *matHeaderCellDef>Statut</th>
                  <td mat-cell *matCellDef="let element" [ngClass]="{
                            'text-primary':
                              element.statut === 'Aucun contrat sur la propriété',
                            'text-danger': element.statut === 'Propriété sous Contrat'
                          }">
                    <span>{{ element.statut }}</span> <br />

                    <span [hidden]="element.jours_restants<=0">il reste {{ element.jours_restants }} jour avant la fin
                      du contrat </span>
                  </td>
                </ng-container>

                <!-- partenaire Column -->
                <ng-container matColumnDef="partenaire">
                  <th mat-header-cell *matHeaderCellDef>Proprietaire</th>
                  <td mat-cell *matCellDef="let element">
                    <span>{{ element.partenaire }}</span>
                  </td>
                </ng-container>

                <!-- Action Column -->
                <ng-container matColumnDef="action">
                  <th mat-header-cell *matHeaderCellDef class="text-center">
                    Action
                  </th>
                  <td mat-cell *matCellDef="let element" class="text-center">
                    <a mat-icon-button color="primary" routerLink="/propriete/detail-propriete/{{ element.id }}">
                      <mat-icon>edit</mat-icon>
                    </a>

                  </td>
                </ng-container>

                <!-- Header and Row Declarations -->
                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
              </table>
              <!-- Paginator -->
              <mat-paginator [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons></mat-paginator>
            </div>
          </div>
        </div>
      </div>
    </div>